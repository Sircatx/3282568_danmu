<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>æ€ªå°è‘µçš„å¼¹å¹•å½’æ¡£</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        :root { --main-pink: #ff69b4; --bg-pink: #fdf2f5; --item-bg: #fff; }
        body { font-family: -apple-system, sans-serif; background: var(--bg-pink); margin: 0; padding: 20px; color: #444; }
        .container { max-width: 500px; margin: 0 auto; background: white; border-radius: 24px; padding: 25px; box-shadow: 0 10px 30px rgba(255,105,180,0.1); }
        h1 { text-align: center; color: var(--main-pink); font-size: 1.5rem; margin-bottom: 20px; }
        
        .nav-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .back-btn { background: var(--main-pink); color: white; border: none; padding: 8px 15px; border-radius: 10px; cursor: pointer; font-size: 0.9rem; }
        
        .list { display: flex; flex-direction: column; gap: 10px; }
        .file-card { display: flex; align-items: center; padding: 15px; background: var(--item-bg); border: 1px solid #ffe4ed; border-radius: 12px; text-decoration: none; color: #555; transition: all 0.2s; }
        .file-card:hover { border-color: var(--main-pink); background: var(--bg-pink); transform: translateX(5px); }
        .file-card i { margin-right: 12px; font-style: normal; font-size: 1.2rem; }
        .file-name { flex-grow: 1; font-weight: 500; }
        
        .loading { text-align: center; color: var(--main-pink); padding: 40px; }
        .empty { text-align: center; color: #999; padding: 40px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ» æ€ªå°è‘µçš„å¼¹å¹•å½’æ¡£</h1>
        <div id="app">
            <div class="loading">æ­£åœ¨å¬å”¤å½’æ¡£æ•°æ®...</div>
        </div>
    </div>

    <script>
        const repo = "Sircatx/3282568_danmu";
        const app = document.getElementById('app');

        // æ¸²æŸ“é¦–é¡µï¼ˆæœˆä»½æ–‡ä»¶å¤¹ï¼‰
        async function renderHome() {
            app.innerHTML = '<div class="loading">è¯»å–æœˆä»½åˆ—è¡¨ä¸­...</div>';
            try {
                const res = await fetch(`https://api.github.com/repos/${repo}/contents/`);
                const data = await res.json();
                let html = '<div class="list">';
                data.forEach(item => {
                    if (item.type === 'dir' && /^\d{4}-\d{2}$/.test(item.name)) {
                        html += `<a href="javascript:void(0)" class="file-card" onclick="renderFolder('${item.name}')"><i>ğŸ“…</i><span class="file-name">${item.name} å½’æ¡£</span></a>`;
                    }
                });
                app.innerHTML = html + '</div>';
            } catch (e) {
                app.innerHTML = '<div class="empty">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•~</div>';
            }
        }

        // æ¸²æŸ“å…·ä½“æœˆä»½ï¼ˆåªæ˜¾ç¤ºæ—¥æœŸæ–‡ä»¶ï¼‰
        async function renderFolder(folder) {
            app.innerHTML = `<div class="nav-bar"><button class="back-btn" onclick="renderHome()">â¬… è¿”å›</button><span>${folder}</span></div><div class="loading">æ­£åœ¨æŠ“å–æ—¥æœŸæ–‡ä»¶...</div>`;
            try {
                const res = await fetch(`https://api.github.com/repos/${repo}/contents/${folder}`);
                const data = await res.json();
                
                // æ ¸å¿ƒé€»è¾‘ï¼šæ’åºå¹¶è¿‡æ»¤ï¼Œåªæ˜¾ç¤º .txt æ–‡ä»¶
                data.sort((a, b) => b.name.localeCompare(a.name));
                
                let html = `<div class="nav-bar"><button class="back-btn" onclick="renderHome()">â¬… è¿”å›</button><strong>${folder} è¯¦æƒ…</strong></div><div class="list">`;
                let hasFile = false;

                data.forEach(file => {
                    if (file.name.endsWith('.txt')) {
                        hasFile = true;
                        const dateName = file.name.replace('.txt', ''); // å»æ‰åç¼€æ›´ç¾è§‚
                        // ç‚¹å‡»ç›´æ¥è·³è½¬åˆ° CDN åŠ é€Ÿåœ°å€é¢„è§ˆ
                        const viewUrl = `https://jsd.cdn.zzko.cn/gh/${repo}@main/${folder}/${file.name}`;
                        html += `<a href="${viewUrl}" target="_blank" class="file-card"><i>ğŸ“„</i><span class="file-name">${dateName} å¼¹å¹•è®°å½•</span></a>`;
                    }
                });
                
                app.innerHTML = hasFile ? html + '</div>' : '<div class="empty">è¯¥æœˆæš‚æ— è®°å½•</div>';
            } catch (e) {
                app.innerHTML = '<div class="empty">è·å–æ–‡ä»¶å¤±è´¥~</div>';
            }
        }

        renderHome();
    </script>
</body>
</html>
